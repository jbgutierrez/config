# Utility
alias reload='source ~/bin/dotfiles/bash/aliases'
alias ea='gvim -f ~/bin/dotfiles/bash/aliases && reload' # Edit aliases
alias ee='gvim ~/bin/dotfiles/bash/env'
function topcommands() {
  history | awk '{a[$2]++}END{for(i in a){print a[i] " " i}}' | sort -rn | head
}

# GIT aliases
alias gk='gitk --all&'
alias gkr='gitk --all `git reflog | cut -c1-7`'
alias gks'git instaweb'
alias gst='git status'
alias gs='git status '
alias gl='git pull'
alias gp='git push'
alias gd='git diff'
alias gc='git commit -v'
alias gca='git commit -v -a'
alias gcsvn='git svn dcommit'
alias ga='git commit -v --amend'
alias gaa='git commit -v -a --amend'
alias gadd='git add '
alias gb='git branch --color'
alias gbd='git branch -d'
function go() {
  git checkout -b $1 2> /dev/null || git checkout $1
}
alias glog='git log --pretty=format:"%ar - %an - %s"'
alias gapply='git stash apply && git stash clear'
alias gresolve='git add -u && git rebase --continue'

function garchive() {
  git archive master | bzip2 >source-tree.tar.bz2
}
# Git clone from GitHub
function gclone() {
  git clone git://github.com/$1/$2.git
}

# Vim
alias g='gvim --remote-silent'

# Ruby
alias r="rake"
# Puts you in a 1.9 sandbox
# alias ruby19="export PATH=/opt/ruby19/bin:$PATH"

# Rails
alias sp='./script/plugin'

sc () {
  if [ -f ./script/rails ]; then 
    rails c $@
  else
    ./script/console $@
  fi
}

sg () {
  if [ -f ./script/rails ]; then
    rails g $@
  else
    ./script/generate $@
  fi
}

ss () {
  if [ -f ./script/rails ]; then 
    rails s $@
  else
    ./script/server $@
  fi
}

#  http://ryan.mcgeary.org/2011/02/09/vendor-everything-still-applies/
alias b="bundle"
alias bi="b install --path vendor"
alias bu="b update"
alias be="b exec"
alias binit="bi && b package && echo 'vendor/ruby' >> .gitignore && echo 'rvm ruby-1.9.2' >> .rvmrc"

alias tl='tail -f log/*.log'

# TDD / BDD
alias at='autotest'
alias aaf='autotest -f' # Don't run all at start
alias as="autospec"

#heroku helpers
alias hp="git push heroku master"
alias hl="heroku logs"

# Django aliases
alias dj='python manage.py'
alias djsp='dj startproject'   # + project_name
alias djss='dj runserver 3000'
alias djsdb='dj syncdb'
alias djrt='dj sqlclear'       # + ModelName
alias djsa='dj startapp'       # + app_name
alias djs='dj shell'

#Google AppEngine
alias gss='dev_appserver.py . -p 3000 -d' # --debug_imports -d'
alias gcd='dev_appserver.py --clear_datastore .'
alias gps='appcfg.py update .'

# ObjectiveC
alias xclean='xcodebuild -target Test clean'
alias xbuild='scan-build -k -V xcodebuild -target Test'

# Bash shortcuts
alias less='less -r'
alias la='ls -lhGta'
alias l='ls -lhGt'  # -l long listing, most recent first
                    # -G color
alias cp='cp -i'
alias mv='mv -i'
alias rm='rm -i'
alias df='df -h'
alias h='history'
alias md='mkdir -p'
function cdh(){
  cd "$HOME/$1"
}
alias c='clear'
alias ..='cd ..'   # up one dir
alias cd..='cd ..'   # up one dir
alias cdl='cd -'  # goto last dir cd'ed from
alias cdd='cd -'  # goto last dir cd'ed from
function take() {
  mkdir -p "$1"
  cd "$1"
}
alias q='exit'

# Shortcuts to each project folder
alias cdprojects="cd $PROJECTS_FOLDER"
for project_path in $PROJECTS_FOLDER/*; do
  if [ -d $project_path ]; then
    subfolder=`echo $project_path | /usr/bin/sed 's/.*\///'`
    alias "cd$subfolder"="cd $project_path"
    alias "e$subfolder"="gvim $project_path"
  fi
done

# Remember path position
export REMEMBERME_PATH=$HOME
alias rememberme='export REMEMBERME_PATH=$PWD'
alias cdrememberme='cd "$REMEMBERME_PATH"'

# List folders size
function dufolders() {
  du -h --max-depth=1
}

# File compression
function zipr() {
  zip -r $1.zip $1
}
function zip2bzip() {
  cat $1 | gunzip | bzip2 !#:1:s/gz/bz2
}

# Processes
alias tu='top -o cpu' # cpu
alias tm='top -o vsize' # memory
function killnamed () {
  ps ax | grep $1 | cut -d ' ' -f 1 | xargs kill -9
}

# Finder
alias o='open . &'
alias ff='open -a Firefox'

# Recursively Remove .DS_Store files in OS X
alias clean='find . -name *.DS_Store -type f -exec rm {} \;'

# Update Text Bundles
alias update_bundles='svn update ~/Library/Application\ Support/TextMate/Bundles'

# Instant web sharing via webrick
alias webshare='ruby -e "require\"webrick\";w=WEBrick::HTTPServer.new(:Port=>8000,:DocumentRoot=>Dir::pwd);Signal.trap(2){w.shutdown};w.start"'

# Social activity
function tweet() {
  curl -u user:pass http://twitter.com/statuses/update.xml -d status="$*"
}

# Top man pages
function topmanpages() {
  echo "man 1 intro - a tutorial that gets you started with Linux if you have never used it.
man 2 syscalls - lists all Linux system calls by kernel version.
man 1 select_tut - select() system call tutorial.
man 3 string - lists all <string.h> string manipulation functions.
man 3 stdio - lists and describes all <stdio.h> standard input/output library functions.
man 3 errno - lists and describes all errno error numbers.
man 4 console_codes - Linux console escape and control sequences.
man 4 full - /dev/full - a device that simulates a full device.
man 5 proc - lots of info about the /proc filesystem.
man 5 filesystems - lists various Linux filesystems.
man 7 bootparam - a tutorial and reference of Linux kernel boot parameters.
man 7 charsets - a Linux programmer's view of character sets and internationalization.
man 7 glob - how pathname globbing works.
man 7 hier - description of the Linux file system hierarchy.
man 7 operator - C language operator precedence and associativity table.
man 7 regex - basic and extended regular expression overview.
man 7 suffixes - lists common Linux file suffixes and the associated file types.
man 7 time - overview of time and timers.
man 7 units - kilo, kibi, mega, mebi, giga, gibi, ... - decimal (SI) and binary system of units.
man 7 utf8 - description of UTF-8 encoding.
man 7 url - description of URIs, URLs and URNs."
}

# RVM settings
# => $ bash < <( curl http://rvm.beginrescueend.com/releases/rvm-install-head )
[[ -s $HOME/.rvm/scripts/rvm ]] && source $HOME/.rvm/scripts/rvm

# Cygwin customizations and walkarounds
if [ $_YAP_CYGWIN ]; then
  # Shortcuts to each project folder
  alias cdprojects="cd $PROJECTS_FOLDER"
  for path in $PROJECTS_FOLDER/*; do
    if [ -d $path ]; then
      subfolder=`echo $path | sed 's/.*\///' | tr "[:upper:]" "[:lower:]"`
      alias "cd$subfolder"="cd $path/Software/trunk"
      alias "e$subfolder"="e $path/Software/trunk"
      alias "u$subfolder"="cd $path/Software/trunk && git svn rebase && cd -"
      alias "o$subfolder"='"/cygdrive/c/Archivos de programa/Microsoft Visual Studio 8/Common7/IDE/devenv.exe" "D:/Proyectos/$subfolder/Software/trunk/$ subfolder.sln"&'
    fi
  done

  # Cygwin walkarounds
  alias rake='C:/ruby/bin/rake'
  alias gem='C:/ruby/bin/gem'
  alias gvim='gvim.bat'
  alias reload='cd && source bin/dotfiles/bash/aliases && cd -'
  alias ea='cd && gvim -f bin/dotfiles/bash/aliases && reload && cd -' # Edit aliases
  alias ee='cd && gvim bin/dotfiles/bash/env && cd -'
fi
